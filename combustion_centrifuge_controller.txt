alias full r1
alias stress r2
alias rpm r3
alias throttle r4
alias limiter r5
alias memrpm r6
alias valid r7

s d0 CombustionLimiter 100
main:
move throttle 0
ls full d0 0 Occupied
beqz full idle1
ls valid d0 0 OccupantHash
beq valid -1234745580 start
beq valid 2131916219 start
beq valid -1641500434 start
j invalid
start:
l throttle d0 Throttle
add throttle throttle 10
s d0 Throttle throttle
sleep 5
waitstart:
l stress d0 Stress
ls full d0 0 Occupied
bnez stress waitstart
beqz full stop
j start

stop:
s d0 Throttle 0
s d0 On 0
l stress d0 Stress
l rpm d0 Rpm
beqz rpm idle1
bnez stress stop
j stop

idle1:
s d0 On 1
l full d0 Reagents
s d0 Open 1
bnez full idle1
idle2:
s d0 Open 0
ls full d0 0 Occupied
bnez full main
j idle2
invalid:
ls full d0 0 Occupied
bnez full invalid
j main
